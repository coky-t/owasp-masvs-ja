# V2: データストレージとプライバシー要件

## 管理目標

ユーザー資格情報や個人情報などの機密データの保護はモバイルセキュリティで重要な焦点となっています。まず、IPCのようなオペレーティングシステムのメカニズムが不適切に使用されている場合、同じデバイス上で実行されている他のアプリに機密データが意図せず晒されてしまいます。また、データはクラウドストレージ、バックアップ、キーボードキャッシュから意図せず漏れることもあります。さらに、他のタイプのデバイスに比べてモバイルデバイスは簡単に紛失したり盗まれたりします。そのため、第三者が物理的にアクセスできることがより可能性の高いシナリオとなります。その場合、機密データの取得をより困難にするために追加の保護を実装することができます。

注意：MASVS はアプリ中心であるため、MDM ソリューションにより行われるようなデバイスレベルのポリシーは対象ではありません。私たちはエンタープライズのコンテキストでこのようなポリシーを使用することにより、データセキュリティをさらに強化することを推奨します。

### 機密データの定義

MASVS のコンテキストにおける機密データは、以下のように、ユーザー資格情報および特定のコンテキストにおいて機密とみなされるその他のデータの両方に関係します。

- なりすまし犯罪に悪用される可能性のある個人識別情報 (PII)：社会保障番号、クレジットカード番号、銀行口座番号、医療情報。
- 被害を受けた場合に風評被害や財務コストにつながる機密性の高いデータ：契約情報、秘密保持契約の対象となる情報、管理情報。
- 法律やコンプライアンス上の理由により保護する必要のあるすべてのデータ。

<div style="page-break-after: always;"></div>

## セキュリティ検証要件

大部分のデータ開示の問題は単純なルールに従うことで防ぐことが可能です。この章に記載されているほとんどのコントロールはすべての検証レベルで必須です。

| # | 説明 | L1 | L2 |
| --- | --- | --- | --- |
| **2.1** | 個人識別情報、ユーザー資格情報、暗号化鍵などの機密データを格納するために、システムの資格情報保存機能が適切に使用されている。 | ✓ | ✓ |
| **2.2** | 機密データはアプリコンテナまたはシステムの資格情報保存機能の外部に保存されていない。 | ✓ | ✓ |
| **2.3** | 機密データはアプリケーションログに書き込まれていない。 | ✓ | ✓ |
| **2.4** | 機密データはアーキテクチャに必要な部分でない限りサードパーティと共有されていない。 | ✓ | ✓ |
| **2.5** | 機密データを処理するテキスト入力では、キーボードキャッシュが無効にされている。 | ✓ | ✓ |
| **2.6** | 機密データはIPCメカニズムを介して公開されていない。 | ✓ | ✓ |
| **2.7** | パスワードやピンなどの機密データは、ユーザーインタフェースを介して公開されていない。 | ✓ | ✓ |
| **2.8** | 機密データはモバイルオペレーティングシステムにより生成されるバックアップに含まれていない。 |   | ✓ |
| **2.9** | バックグラウンド時にアプリはビューから機密データを削除している。 |  | ✓ |
| **2.10** | アプリは必要以上に長くメモリ内に機密データを保持せず、使用後は明示的にメモリがクリアされている。 |  | ✓ |
| **2.11** | アプリは最低限のデバイスアクセスセキュリティポリシーを適用しており、ユーザーにデバイスパスコードを設定することなどを必要としている。 |  | ✓ |
| **2.12** | アプリは処理される個人識別情報の種類をユーザーに通知しており、同様にユーザーがアプリを使用する際に従うべきセキュリティのベストプラクティスについて通知している。 |  | ✓ |

## 参考情報

OWASP モバイルセキュリティテストガイドでは、このセクションに記載されている要件を検証するための詳細な手順を提供しています。

- Android 用 - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x05d-Testing-Data-Storage.md
- iOS 用 - https://github.com/OWASP/owasp-mstg/blob/master/Document/0x06d-Testing-Data-Storage.md

詳しくは以下の情報を参照してください。

- OWASP Mobile Top 10: M2 - Insecure Data Storage: https://www.owasp.org/index.php/Mobile_Top_10_2016-M2-Insecure_Data_Storage
- CWE: https://cwe.mitre.org/data/definitions/922.html
